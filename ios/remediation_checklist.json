[
  {
    "id": "SEC-001",
    "priority": "A",
    "cvss_v4": 9.1,
    "description": "Missing WeatherKit entitlement causes runtime crashes",
    "fix": "Add com.apple.developer.weatherkit to WeatherSunscreen.entitlements and configure in Apple Developer portal",
    "owner": "ios-team",
    "file": "WeatherSunscreen/WeatherSunscreen.entitlements",
    "effort_hours": 0.5
  },
  {
    "id": "SEC-002",
    "priority": "A",
    "cvss_v4": 8.6,
    "description": "Race condition in LocationDelegate causes memory corruption",
    "fix": "Implement proper actor isolation using @MainActor or serial DispatchQueue for locationDelegate access",
    "owner": "backend-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:96-134",
    "effort_hours": 2
  },
  {
    "id": "SEC-003",
    "priority": "A",
    "cvss_v4": 8.2,
    "description": "Overly permissive location permissions violate user privacy",
    "fix": "Remove NSLocationAlwaysUsageDescription, use only NSLocationWhenInUseUsageDescription with clear justification",
    "owner": "product-team",
    "file": "WeatherSunscreen/Info.plist:48-53",
    "effort_hours": 1
  },
  {
    "id": "SEC-005",
    "priority": "A",
    "cvss_v4": 7.8,
    "description": "(Removed) Finding applied to deleted LiquidGlass native module",
    "fix": "N/A - module removed in v3.0.0",
    "owner": "ios-team",
    "file": "",
    "effort_hours": 0
  },
  {
    "id": "SEC-006",
    "priority": "A",
    "cvss_v4": 7.2,
    "description": "Unsafe forced unwrapping causes crashes",
    "fix": "Replace force unwrap at line 91 with guard let locationManager = await MainActor.run(...) else { throw }",
    "owner": "ios-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:91",
    "effort_hours": 0.5
  },
  {
    "id": "SEC-007",
    "priority": "A",
    "cvss_v4": 8.1,
    "description": "Thread safety violations with @MainActor properties",
    "fix": "Ensure all access to @MainActor properties happens on MainActor or use proper synchronization",
    "owner": "ios-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:13-15",
    "effort_hours": 3
  },
  {
    "id": "SEC-008",
    "priority": "A",
    "cvss_v4": 7.0,
    "description": "Hardcoded absolute paths break build portability",
    "fix": "Replace PROJECT_ROOT with relative path: PROJECT_ROOT=\"$(cd \"$(dirname \"$0\")/../..\" && pwd)\"",
    "owner": "devops",
    "file": "ios/scripts/fix-fabric-headers.sh:11",
    "effort_hours": 1
  },
  {
    "id": "SEC-004",
    "priority": "B",
    "cvss_v4": 7.4,
    "description": "No certificate pinning enables MITM attacks",
    "fix": "Implement TLS certificate pinning using URLSession delegate or Alamofire with pinning",
    "owner": "backend-team",
    "file": "Network Layer",
    "effort_hours": 4
  },
  {
    "id": "SEC-009",
    "priority": "B",
    "cvss_v4": 6.8,
    "description": "No input validation for coordinates",
    "fix": "Add validation: latitude ∈ [-90,90], longitude ∈ [-180,180] before API calls",
    "owner": "backend-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:72-76",
    "effort_hours": 1
  },
  {
    "id": "SEC-010",
    "priority": "B",
    "cvss_v4": 6.5,
    "description": "Timeout handler may execute after completion",
    "fix": "Store timeout Task and cancel it in completion handler before setting locationDelegate to nil",
    "owner": "ios-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:125-132",
    "effort_hours": 2
  },
  {
    "id": "SEC-011",
    "priority": "B",
    "cvss_v4": 5.3,
    "description": "Error messages expose implementation details",
    "fix": "Return generic user errors, log detailed errors internally with correlation IDs",
    "owner": "ios-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift:286-310",
    "effort_hours": 1
  },
  {
    "id": "SEC-012",
    "priority": "B",
    "cvss_v4": 6.2,
    "description": "Missing privacy manifest declarations",
    "fix": "Add NSPrivacyAccessedAPICategoryLocation with reason codes to PrivacyInfo.xcprivacy",
    "owner": "ios-team",
    "file": "WeatherSunscreen/PrivacyInfo.xcprivacy",
    "effort_hours": 0.5
  },
  {
    "id": "SEC-013",
    "priority": "B",
    "cvss_v4": 5.8,
    "description": "(Removed) Finding applied to deleted LiquidGlass native module",
    "fix": "N/A - module removed in v3.0.0",
    "owner": "ios-team",
    "file": "",
    "effort_hours": 0
  },
  {
    "id": "SEC-014",
    "priority": "B",
    "cvss_v4": 6.9,
    "description": "No jailbreak detection allows tampering",
    "fix": "Implement jailbreak detection: check for Cydia, suspicious files, fork() behavior",
    "owner": "security-team",
    "file": "Application Layer",
    "effort_hours": 4
  },
  {
    "id": "SEC-015",
    "priority": "B",
    "cvss_v4": 5.1,
    "description": "(Removed) Finding applied to deleted LiquidGlass native module",
    "fix": "N/A - module removed in v3.0.0",
    "owner": "ios-team",
    "file": "",
    "effort_hours": 0
  },
  {
    "id": "SEC-016",
    "priority": "C",
    "cvss_v4": 4.8,
    "description": "Weak Swift concurrency checking",
    "fix": "Change SWIFT_STRICT_CONCURRENCY from 'minimal' to 'complete' in Podfile:81",
    "owner": "ios-team",
    "file": "ios/Podfile:81",
    "effort_hours": 2
  },
  {
    "id": "SEC-017",
    "priority": "C",
    "cvss_v4": 4.5,
    "description": "No code obfuscation enables reverse engineering",
    "fix": "Integrate SwiftShield or similar obfuscation tool in build pipeline",
    "owner": "security-team",
    "file": "Build Configuration",
    "effort_hours": 8
  },
  {
    "id": "SEC-018",
    "priority": "C",
    "cvss_v4": 4.2,
    "description": "Unnecessary UISupportsMultipleScenes capability",
    "fix": "Set UISupportsMultipleScenes to false in Info.plist:84",
    "owner": "ios-team",
    "file": "WeatherSunscreen/Info.plist:84",
    "effort_hours": 0.5
  },
  {
    "id": "SEC-019",
    "priority": "C",
    "cvss_v4": 4.7,
    "description": "Missing binary protection flags",
    "fix": "Enable PIE, stack canaries, FORTIFY_SOURCE in build settings",
    "owner": "devops",
    "file": "Build Configuration",
    "effort_hours": 1
  },
  {
    "id": "SEC-020",
    "priority": "C",
    "cvss_v4": 3.9,
    "description": "(Removed) Finding applied to deleted LiquidGlass native module",
    "fix": "N/A - module removed in v3.0.0",
    "owner": "ios-team",
    "file": "",
    "effort_hours": 0
  },
  {
    "id": "PERF-001",
    "priority": "B",
    "cvss_v4": 3.5,
    "description": "(Removed) Finding applied to deleted LiquidGlass native module",
    "fix": "N/A - module removed in v3.0.0",
    "owner": "ios-team",
    "file": "",
    "effort_hours": 0
  },
  {
    "id": "PERF-002",
    "priority": "C",
    "cvss_v4": 2.8,
    "description": "No caching for WeatherKit API calls",
    "fix": "Implement 10-minute cache using NSCache for weather data",
    "owner": "backend-team",
    "file": "modules/weather-native-module/ios/WeatherNativeModule.swift",
    "effort_hours": 3
  }
]
