# Security and Privacy Guidelines

## Data Storage
- **AsyncStorage**: Only store non-sensitive data in AsyncStorage
- **Encryption**: Never store passwords, API keys, or personal data without encryption
- **Storage Keys**: Use namespaced keys (e.g., `@chat_dns_*`) to avoid conflicts

## Network Security
- **DNS Queries**: DNS queries are inherently not encrypted (except DoH)
- **HTTPS Priority**: Use `preferDnsOverHttps` setting for enhanced privacy
- **Server Validation**: Validate DNS server responses before processing
- **Rate Limiting**: Implement rate limiting to prevent abuse (see [src/services/dnsService.ts](mdc:src/services/dnsService.ts))

## Input Validation
- **User Input**: Sanitize all user input before DNS encoding
- **Message Length**: Enforce reasonable limits on message length
- **Special Characters**: Handle special characters appropriately for DNS encoding
- **XSS Prevention**: Avoid rendering raw user input in UI components

## Native Module Security
- **iOS Permissions**: [ios/DNSChat/Info.plist](mdc:ios/DNSChat/Info.plist) should only request necessary permissions
- **Android Permissions**: [android/app/src/main/AndroidManifest.xml](mdc:android/app/src/main/AndroidManifest.xml) should follow principle of least privilege
- **Network Access**: Only request network permissions when needed

## Privacy Considerations
- **DNS Logging**: DNS queries are logged for debugging; consider privacy implications
- **User Data**: Minimize collection of personal identifiable information
- **Third-party Services**: Be aware of data sent to third-party DNS servers
- **App Tracking**: Follow platform guidelines for app tracking transparency

## Code Security
- **No Hardcoded Secrets**: Never commit API keys, passwords, or secrets to version control
- **Input Sanitization**: Always validate and sanitize external inputs
- **Error Handling**: Don't expose sensitive information in error messages
- **Dependencies**: Keep dependencies updated for security patches

## Platform Security
- **iOS Entitlements**: [ios/DNSChat/DNSChat.entitlements](mdc:ios/DNSChat/DNSChat.entitlements) should be minimal
- **Android Security**: Use appropriate security configurations in build.gradle
- **Expo Security**: Follow Expo security best practices for plugins and native modules

## Do Not
- **Store sensitive data** in AsyncStorage without encryption
- **Log user messages** or personal information
- **Expose internal APIs** or endpoints
- **Bypass platform security** features
- **Use deprecated** or insecure APIs
description:
globs:
alwaysApply: false
---
